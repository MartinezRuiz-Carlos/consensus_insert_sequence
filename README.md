# Consensus insert sequence calling

Scripts to generate a consensus inserted sequence of insertions called by [Savana](https://github.com/cortes-ciriano-lab/savana).
The consusensus is based on multi-alignment of the fasta file produced by Savan for insertion calls. The script `preprocess_insert_sequence_fa.sh` takes as an input the `.inserted_sequences_savana.fa` file generated by Savana. It then splits it per variant is run through `consensus_insert_sequence.py`. The script `run_consensus_test.array.sh` runs the Python script through all variants of one patient on the Crick cluster. 

## Software and libraries required
- [Mafft](https://mafft.cbrc.jp/alignment/server/index.html) for multiple alignment
- Python libraries:
    * Bio
    * io
    * pathlib
    * argparse

NOTE: The pre-processing step is too slow, future versions will be done with [SeqKit grep](https://bioinf.shenwei.me/seqkit/usage/#grep)